import{_ as n,X as s,Y as a,a2 as e}from"./framework-c2b0d87a.js";const t="/assets/image-2023-02-01_17-51-54-980-18-pipe管道转换-f1ac855a.png",p={},i=e('<figure><img src="'+t+`" alt="image-2023-02-01_17-51-54-980-18-pipe管道转换" tabindex="0" loading="lazy"><figcaption>image-2023-02-01_17-51-54-980-18-pipe管道转换</figcaption></figure><h1 id="管道" tabindex="-1"><a class="header-anchor" href="#管道" aria-hidden="true">#</a> 管道</h1><p>可以做两件事</p><ol><li>转换，可以将前端传入的数据转成成我们需要的数据</li><li>验证 类似于前端的 rules 配置验证规则</li></ol><p>我们先来讲一下转换 Nestjs 提供了八个内置转换 API</p><ul><li>ValidationPipe</li><li>ParseIntPipe</li><li>ParseFloatPipe</li><li>ParseBoolPipe</li><li>ParseArrayPipe</li><li>ParseUUIDPipe</li><li>ParseEnumPipe</li><li>DefaultValuePipe</li></ul><h2 id="案例-1-我们接受的动态参数希望是一个-number-类型-现在是-string" tabindex="-1"><a class="header-anchor" href="#案例-1-我们接受的动态参数希望是一个-number-类型-现在是-string" aria-hidden="true">#</a> 案例 1 我们接受的动态参数希望是一个 number 类型 现在是 string</h2><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;:id&#39;</span><span class="token punctuation">)</span>
  <span class="token function">findOne</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> id<span class="token punctuation">,</span> <span class="token string">&#39;=====&gt;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//number =====&gt;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pService<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="案例-2-验证-uuid" tabindex="-1"><a class="header-anchor" href="#案例-2-验证-uuid" aria-hidden="true">#</a> 案例 2 验证 UUID</h2><p>安装 uuid</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> uuid <span class="token parameter variable">-S</span>

<span class="token function">npm</span> <span class="token function">install</span> @types/uuid <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成一个 uuid</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> uuid <span class="token keyword">from</span> <span class="token string">&#39;uuid&#39;</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span><span class="token function">v4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>/p/e2f02423-9348-4e84-9a40-0f5002c2b5eb</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;:id&#39;</span><span class="token punctuation">)</span>
  <span class="token function">findOne</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span> ParseUUIDPipe<span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pService<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>现在访问 <code>@Get(&#39;:id&#39;)</code> 必须满足 uuid 的规则，否则访问不通过</p>`,16),o=[i];function c(l,u){return s(),a("div",null,o)}const d=n(p,[["render",c],["__file","18-pipe管道转换.html.vue"]]);export{d as default};
